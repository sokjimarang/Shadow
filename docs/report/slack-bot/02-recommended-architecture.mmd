graph TB
    subgraph Desktop["üíª Desktop App (Tauri + shadow-web)"]
        _d1[" "]

        NextJS["Next.js UI<br/>(Í∏∞Ï°¥ shadow-web)"]
        TauriCore["Tauri Core (Rust)"]
        ScreenCap["Screen Capture<br/>Native APIs"]
        InputTrack["Input Tracking"]
        FileSystem["File System"]

        _d1 ~~~ NextJS
        NextJS --> TauriCore
        TauriCore --> ScreenCap
        TauriCore --> InputTrack
        TauriCore --> FileSystem
    end

    subgraph Cloud["‚òÅÔ∏è Cloud Backend (Vercel)"]
        _c1[" "]

        API["FastAPI<br/>/api/v1/*"]
        VisionAI["Vision AI<br/>Claude Opus 4.5"]
        PatternEngine["Pattern Detection<br/>LLM-based"]
        HITLGen["HITL Generator"]
        SpecBuilder["Spec Builder"]

        _c1 ~~~ API
        API --> VisionAI
        VisionAI --> PatternEngine
        PatternEngine --> HITLGen
        HITLGen --> SpecBuilder
    end

    subgraph Data["üóÑÔ∏è Supabase"]
        _s1[" "]

        DB[("PostgreSQL<br/>sessions<br/>patterns<br/>specs")]
        Storage[("Object Storage<br/>Screenshots<br/>Videos")]

        _s1 ~~~ DB
    end

    subgraph Integration["üí¨ Integrations"]
        _i1[" "]

        SlackBot["Slack Bot<br/>HITL Questions"]
        WebUI["Web Dashboard<br/>shadow-web"]

        _i1 ~~~ SlackBot
    end

    ScreenCap -->|1. ÎÖπÌôî Îç∞Ïù¥ÌÑ∞| FileSystem
    FileSystem -->|2. ÏóÖÎ°úÎìú| Storage
    NextJS -->|3. POST /observations| API
    Storage -->|4. Ïù¥ÎØ∏ÏßÄ URL| API
    API -->|5. Î∂ÑÏÑù Í≤∞Í≥º| DB
    PatternEngine -->|6. Ìå®ÌÑ¥ Í∞êÏßÄ| DB
    HITLGen -->|7. ÏßàÎ¨∏ Ï†ÑÏÜ°| SlackBot
    SlackBot -.->|8. ÏÇ¨Ïö©Ïûê ÏùëÎãµ| API
    API -->|9. ÏùëÎãµ Ï†ÄÏû•| DB
    SpecBuilder -->|10. Î™ÖÏÑ∏ÏÑú ÏÉùÏÑ±| DB
    DB -.->|11. Ï°∞Ìöå| WebUI
    DB -.->|12. Ï°∞Ìöå| NextJS

    style NextJS fill:#61dafb,stroke:#20232a,stroke-width:2px,color:#000
    style TauriCore fill:#ffc131,stroke:#24c8db,stroke-width:2px,color:#000
    style API fill:#009688,stroke:#00796b,stroke-width:2px
    style DB fill:#3ecf8e,stroke:#2aa876,stroke-width:2px,color:#000
    style Storage fill:#3ecf8e,stroke:#2aa876,stroke-width:2px,color:#000
    style SlackBot fill:#4a154b,stroke:#611f69,stroke-width:2px

    style _d1 fill:none,stroke:none,color:transparent
    style _c1 fill:none,stroke:none,color:transparent
    style _s1 fill:none,stroke:none,color:transparent
    style _i1 fill:none,stroke:none,color:transparent
