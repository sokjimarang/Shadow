# 패턴 정의 및 세션/유사도 논의 기록

아래는 대화에서 사용자가 던진 질문과 그에 대한 응답을 **원문을 최대한 유지**하여 정리한 기록입니다.

---

## 1차 질의 (패턴 정의 논의 시작)

**사용자**
```
1. 3개 이상 세션을 비교하는게 맞아. 근데, 그 전에 '패턴' 이라는 것에 대해 어떻게 정의할지부터 논의해봐야 할 필요가 있어. 언제부터 패턴이라고 정의할 수 있을까? 지금은 단순히 3번 이상 관측으로 정했지만, 좀 더 엄밀하거나 확고한 기준이 필요하지 않을까 싶어. 2. LLM 패턴은 감지는 /analyze APi에서 실행하는게 맞아. 3. 너는 작업을 수행하지마. 검토만 해.그리고 내가 물어본 것에 먼저 대답해봐
```

**응답**
```
요청대로 먼저 “패턴” 정의부터 답할게. (작업/수정은 하지 않고 검토·논의만 진행)

패턴 정의(해커톤 친화 + 엄밀성 확보)
- 핵심 개념: “여러 세션에서 반복되는 **핵심 행동 시퀀스**(core sequence)”
- 단순 3회 관측은 **필요조건**이지만 **충분조건은 아님** → 반복성 + 유사성 + 핵심성(길이/구조)까지 봐야 패턴으로 인정

**권장 운영 기준 (간단하지만 확고한 기준)**
1) **세션 단위 반복**  
   - 동일/유사한 시퀀스가 **3개 이상 세션**에서 관측됨  
2) **유사성 임계치**  
   - 각 세션에서 핵심 시퀀스가 최소한 **유사도 ≥ 0.8**(혹은 “action+target+app 기준 70% 이상 일치”)  
3) **핵심성/길이**  
   - 핵심 시퀀스 길이 **2 step 이상**  
   - “의미 있는 작업 단위”로 볼 수 있어야 함(예: 단일 클릭 반복은 제외 가능)  
4) **순서 보존**  
   - 핵심 시퀀스의 상대적 순서는 세션마다 유지됨 (중간에 다른 액션이 끼어들어도 허용)

→ 이 4개를 만족하면 “패턴”으로 정의.  
그 외는 “후보 패턴(candidate)”로 분류.

**좀 더 엄밀하게 하고 싶다면(하지만 과잉 엔지니어링은 피함)**
- 패턴 신뢰도 점수 = f(세션 수, 평균 유사도, 시퀀스 길이)  
- 예: `confidence = min(1, (support/3) * avg_similarity * (len/2))`  
- 기준값 예: `confidence ≥ 0.6`이면 패턴 인정  
→ 계산은 단순, 설명 가능, 튜닝 가능

---

질문에 대한 내 답
- “언제부터 패턴이라고 정의?”  
  **3개 이상 세션에서 유사한 핵심 시퀀스가 관측되고(반복성), 유사도 기준을 넘으며(일관성), 최소 2-step 이상의 의미 있는 시퀀스인 경우**를 패턴으로 정의하는 게 적절해.  
  단순 “3회 관측”만으로는 변형/우연/잡음이 섞일 가능성이 있어 충분조건이 아님.

---

확인 질문(정의 확정을 위해 필요)
- “패턴”을 **행동 시퀀스 단위**로 볼지, 아니면 **업무 의도 단위**로 볼지?
- 세션 경계는 어떻게 정할지? (1회 녹화 = 1세션인지)
- 단일 액션 반복(예: 같은 버튼 3번 클릭)은 패턴으로 인정할지?

---

요청한 사항 확인
- LLM 패턴 감지는 `/analyze`에서 실행하는 게 맞다는 점 이해했어.
- 작업은 수행하지 않겠어. (정의/검토만)

원하면 위 정의를 PRD 표현으로 정리하거나, “패턴/후보패턴/비패턴” 구분 기준을 표로 깔끔하게 정리해줄게.
```

---

## 2차 질의 (세션/유사도/개념 체계 확장)

**사용자**
```
1. 세션은 무슨 기준으로 나눌 것인지? 2. 유사도는 어떻게 체크할거야? 3. 현재는 규칙 기반이 아니라 LLM이 자의적 판단을 통해 정의하자. 혹시 현재 패턴을 판단하는 과정에서 네가 제시한 것과 같은 엄격한 규칙이 적용되고 있나? 4. 세션 단위를 어떻게 나눌지도 한번 너의 의견을 제시해봐. 6. 단일 액션 반복은 패턴으로 인정할 순 없다고 봐. 7. 패턴은 행동 시퀀스 단위이고, 패턴보다 상위의 개념으로서 업무 의도 단위가 존재해야 할 것 같아. 8.이 논의 과정을 바탕으로 개념적으로 정립해봐. 단순 행동, 행동 패턴, 업무 의도, (그 상위레벨들) 즉, 이건 업무를 개념적으로 쪼개는 일이야.
```

**응답**
```
아래는 질문 순서대로 답변 + 마지막에 개념 체계 정리야. (작업/수정 없음, 논의만)

1) 세션 기준은 무엇이 좋나?
- **최우선: 사용자/시스템의 명시적 start/stop** (가장 명확, 해커톤 친화)
- **보조: 자동 분할 규칙**  
  - **장시간 idle**(예: 2–5분 이상 입력/화면 변화 없음)  
  - **업무 컨텍스트 전환**(앱/창/탭 변화 + 다른 목표 징후)  
  - **목표 완료 신호**(예: “전송 완료”, “저장됨”, 상태 변화)
- 해커톤 기준으로는 “명시적 녹화 세션 = 1 세션”이 가장 현실적이고 설명 가능해.

2) 유사도는 어떻게 체크?
- 지금 전제(LLM이 자의적 판단)라면, **LLM에게 ‘유사하다’의 기준을 명시**하고, 결과에 “유사도 판단 근거(핵심 시퀀스)“를 포함시키는 방식이 적절.
- 예시 기준(LLM 프롬프트에 자연어로 넣기):
  - 핵심 행동(앱/타겟/의미) 70% 이상 일치
  - 순서가 대체로 유지됨
  - 변형은 허용하되 핵심 step은 유지
- 즉, **정량 계산은 안 하더라도, LLM이 판단할 ‘질적 규칙’을 명시**해야 “자의적”이지만 설명 가능한 판단이 됨.

3) 지금 LLM이 엄격한 규칙을 적용하고 있나?
- **아니오.**
  - 현재 LLM 프롬프트에는 “3회 이상 반복”만 서술되어 있고, 실제로 **세션 비교도 하지 않고**, **유사도/핵심 시퀀스 기준도 강제되지 않음**.
  - 즉, **자의적 판단이긴 한데**, 그 자의성이 “명시된 기준에 의해 안내되는 자의성”이 아니라 **자유 판단에 가까움**.

4) 세션 단위 의견 (제안)
- **기본: 사용자 녹화 세션 기준**
- **보조 규칙 (자동)**  
  - idle threshold 분리  
  - 앱 컨텍스트 변경 + 새로운 목표 행동 연속 (예: “새 탭 열고 검색 시작”)  
  - 상태 변화 완료 이벤트 (“저장 완료”, “전송 완료”)
- 해커톤에서는 기본만으로 충분하고, 자동 분리는 “옵션”으로 남겨도 됨.

6) 단일 액션 반복은 패턴으로 인정 X  
- 동의. **단일 액션 반복은 패턴이 아니라 습관/잡음**으로 분리해야 함.

7) 패턴은 행동 시퀀스 단위, 상위에 업무 의도 단위 존재  
- 동의. 패턴은 “실행 방식”이고, 상위에 “의도(목표)”가 있어야 함.

8) 개념 정립: 업무를 분해하는 레벨 구조
아래처럼 정리하는 게 가장 설명 가능하고 확장 가능해.

**1. 단순 행동 (Action)**
- 한 번의 클릭/입력/스크롤 등.
- 단위가 가장 작고 맥락이 약함.

**2. 행동 시퀀스 (Sequence)**
- 2개 이상 행동의 연속.  
- 의미는 생길 수 있지만 **반복성은 없음**.

**3. 행동 패턴 (Pattern)**
- 여러 세션에서 반복 관측되는 **핵심 시퀀스**.
- 변형은 허용하지만 핵심 step은 유지됨.
- “어떻게 하는가(How)”에 해당.

**4. 업무 의도 (Task/Intent)**
- 패턴들이 향하는 **목표/의미 단위**.
- 예: “메일에서 요청사항 찾기”, “스프레드시트 업데이트”
- “왜 하는가(Why)”에 해당.

**5. 워크플로우/프로세스 (Workflow/Process)**
- 여러 업무 의도가 연결된 상위 구조.
- 예: “문의 대응 업무”, “월간 리포트 생성 프로세스”

요약하면:
- **Action → Sequence → Pattern(How) → Task/Intent(Why) → Workflow(Process)**

---

정리하면, 지금은 LLM이 판단하는 것 같지만 **‘자의적 판단’이 아니라 ‘규칙으로 안내된 판단’이 되어야** 해.  
그리고 패턴은 “반복 + 핵심 시퀀스 + 최소 길이”가 핵심이고, 그 상위에 “업무 의도”를 따로 놓는 게 구조적으로 맞아.

원하면 이 개념 정리를 PRD 문구로 정리해 줄게.
```

---

## 3차 요청 (문서화 요청)

**사용자**
```
일단 지금까지 논의한 것을 모조리 정리해서 (나의 질문과 너의 응답 구조 위주로 정리해봐) 문서화해줘
```

**응답**
```
**논의 정리 (질문/응답 구조 중심)**

Q1. 세션은 무슨 기준으로 나눌 것인지?  
A1.  
- 최우선: 사용자/시스템의 **명시적 start/stop**(녹화 세션)  
- 보조: **idle 기준 분할**(예: 2–5분 이상 무입력), **업무 컨텍스트 전환**(앱/창/탭 변화 + 새 목표 징후), **목표 완료 신호**(저장/전송 완료)  
- 해커톤 기준: **명시적 녹화 세션 = 1 세션**이 가장 현실적

Q2. 유사도는 어떻게 체크할거야?  
A2.  
- 정량 계산보다 **LLM이 판단할 질적 기준을 프롬프트에 명시**  
- 예시 기준: 핵심 행동 70% 이상 일치, 순서 대체로 유지, 변형 허용하되 핵심 step 유지  
- 결론: “자의적 판단”이 아니라 **명시된 규칙으로 안내된 판단**이 되도록 설계

Q3. 현재 LLM 패턴 판단 과정에 엄격한 규칙이 적용되나?  
A3.  
- **아니오.** 현재는 3회 반복만 서술되고, 세션 비교/유사성 기준이 강제되지 않음  
- 즉, LLM이 자의적으로 판단할 여지가 큼

Q4. 세션 단위를 어떻게 나눌지 의견 제시?  
A4.  
- 기본: **녹화 세션 단위**  
- 보조: idle/컨텍스트 전환/목표 완료 신호 기반 자동 분리  
- 해커톤에서는 기본만으로 충분, 자동 분리는 옵션

Q5. 단일 액션 반복은 패턴으로 인정할 수 있나?  
A5.  
- **인정 불가.** 단일 액션 반복은 패턴이 아니라 **습관/잡음**으로 분리

Q6. 패턴과 업무 의도의 관계는?  
A6.  
- **패턴은 행동 시퀀스 단위(How)**  
- 그 상위에 **업무 의도(Why)**가 존재해야 함

Q7. “패턴” 정의가 왜 더 엄밀해야 하나?  
A7.  
- “3회 관측”은 **필요조건**일 뿐 **충분조건이 아님**  
- 반복성 + 유사성 + 핵심성(길이/구조)을 함께 고려해야 함

Q8. 개념 체계(업무를 쪼개는 구조) 제안  
A8.  
- **Action → Sequence → Pattern(How) → Task/Intent(Why) → Workflow(Process)**  
  - Action: 단일 행동  
  - Sequence: 행동 연속  
  - Pattern: 반복되는 핵심 시퀀스  
  - Task/Intent: 패턴의 목적/의미  
  - Workflow/Process: 여러 의도의 상위 구조

---

**합의된 방향 요약**
- 패턴은 **행동 시퀀스 단위**, 상위에 **업무 의도 단위** 존재  
- 패턴 인정을 위해서는 **세션 반복 + 유사성 + 최소 길이**가 필요  
- 단일 행동 반복은 패턴으로 인정하지 않음  
- 세션 기준은 **녹화 세션** 중심 + 자동 분리는 옵션  
- LLM 판단은 **자의적이되, 명시된 규칙으로 안내된 판단**이어야 함
```
